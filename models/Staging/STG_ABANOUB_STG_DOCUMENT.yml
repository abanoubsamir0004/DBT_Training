version: 2

models:
    - name: STG_ABANOUB_NYC_SALES_CLEANEND
      description: This model For cleans-up the raw NYC sales data.
      columns:

        - name: PK_NUMBER
          description: |
            - Unique Primary key.
            - Generated by each row with a unique, incremented number.

        - name: BOROUGH
          description: |
            - Borough ID from the raw data.

        - name: BOROUGH_NAME
          description: |
            - Name of the borough.

        - name: NEIGHBORHOOD
          description: | 
            - Neighborhood name.

        - name: BUILDING_CLASS_CATEGORY
          description: |
            - Category of the building class.

        - name: TAX_CLASS_AT_PRESENT
          description: |
            - Tax class at present. 
            - Check for null values or empty strings in the TAX_CLASS_AT_PRESENT column.

        - name: TAX_SUBCLASS_AT_PRESENT
          description: |
            - Tax subclass at present. 
            - its splitted from TAX_CLASS_AT_PRESENT if not found then 'UNKOWN'.

        - name: TAX_BLOCK
          description: | 
            - Block TAX information.

        - name: TAX_LOT
          description: |
            - Lot TAX information.

        - name: BUILDING_CLASS_AT_PRESENT
          description: | 
            - Building class at present.
            - Check for null values or empty strings in the BUILDING_CLASS_AT_PRESENT column.
            - Replace null or empty values with 'UNKNOWN'.

        - name: ADDRESS
          description: | 
            - Address of the property.

        - name: APARTMENT_NUMBER
          description: |
            - Apartment number.
            - Extract apartment numbers from the ADDRESS column when separated by a comma.
            - If no comma is found, set the value to 'UNKNOWN'

        - name: ZIP_CODE
          description: |
            - Zip code of the property.

        - name: RESIDENTIAL_UNITS
          description: |
            - Number of residential units.
            - Cast RESIDENTIAL_UNITS column to integers after removing commas.
            - Replace values containing '-' with NULL.
            - Check if RESIDENTIAL_UNITS is 0 and set it to the difference between TOTAL_UNITS and COMMERCIAL_UNITS.

        - name: COMMERCIAL_UNITS
          description: |
            - Number of commercial units.
            - Cast COMMERCIAL_UNITS column to integers after removing commas.
            - Replace values containing '-' with NULL.
            - Check if COMMERCIAL_UNITS is 0 and set it to the difference between TOTAL_UNITS and RESIDENTIAL_UNITS

        - name: TOTAL_UNITS
          description: |
            - Total number of units.
            - Cast TOTAL_UNITS column to integers after removing commas.
            - Replace values containing '-' with NULL.
            - Check if TOTAL_UNITS is 0 and set it to the sum of RESIDENTIAL_UNITS and COMMERCIAL_UNITS.

        - name: LAND_SQUARE_FEET
          description: |
            - Land square feet.
            - Cast LAND_SQUARE_FEET column to integers after removing commas.
            - Replace values containing '-' with NULL.

        - name: GROSS_SQUARE_FEET
          description: |
            - Gross square feet.
            - Cast GROSS_SQUARE_FEET column to integers after removing commas.
            - Replace values containing '-' with NULL.

        - name: YEAR_BUILT
          description: | 
            - Year the property was built.
            - Replace YEAR_BUILT values of 0 with NULL

        - name: TAX_CLASS_AT_TIME_OF_SALE
          description: |
            - Tax class at the time of sale.
            - Kept the original TAX_CLASS_AT_TIME_OF_SALE values.

        - name: BUILDING_CLASS_AT_TIME_OF_SALE
          description: |
            - Building class at the time of sale.
            - Kept the original BUILDING_CLASS_AT_TIME_OF_SALE values.

        - name: SALE_PRICE
          description: | 
            - Sale price of the property.
            - Replace values containing '-' or '0' with NULL.
            - Remove '$' symbols and commas from SALE_PRICE.
            - Cast SALE_PRICE to an integer.
            - Set values less than or equal to 1000 to NULL.

        - name: SALE_DATE
          description: | 
            - Date of the sale.
            - Update the year format for data in 2017 and 2018 to 'YYYY-MM-DD'.

